<MudDialog>
    <DialogContent>
        <MudPaper Class="px-4" Style=" margin: auto; box-shadow:none;">
            <div class="head-container mb-5">
                <MudText Typo="Typo.h5" Align="Align.Start" Class="heading-txt mb-2">Send New Notification</MudText>
                <MudButton OnClick="Cancel">
                    <img src="./images/Close.svg" alt="X" />
                </MudButton>
            </div>
            <MudGrid>
                <MudItem md="12">
                    <div class="custom-select-wrapper">
                        <label class="custom-label">Send To</label>
                        <select class="custom-select-new-notifaction">
                            @* <option value="Painter">Employee & Customer</option> *@
                            <option value="Electrician">Employee</option>
                            <option value="Electrician">Customer</option>
                        </select>
                    </div>
                </MudItem>
                <MudItem md="12">
                    <div class="custom-field-container">
                        <span class="custom-label">Notification Title</span>
                        <input type="text" class="custom-input" placeholder="Title" required value="New Task Assign" />
                    </div>
                </MudItem>

                <MudItem md="12">
                    <div>
                        <label class="custom-label">Notification Description</label>
                        <textarea placeholder="  Description" class="notification-description">Need Painter For Paint House</textarea>
                    </div>
                </MudItem>

                <MudItem xs="12" class="d-flex align-center justify-center mt-2 user-container">
                    <span class="avatar-container">
                        <img src="@AvatarImageSrc" alt="Avatar Image" class="avatar-img" />
                    </span>

                         <MudItem class="d-flex flex-column ml-3">
                    <MudButton Variant="Variant.Outlined" class="upload-btn" Style="" OnClick="TriggerFileUpload">
                    Upload icon/ Image
                    </MudButton>

                    <MudButton Variant="Variant.Outlined" Color="Color.Error" Class="mt-2" OnClick="RemoveImage" Disabled="@(!IsImageUploaded)">
                    Remove
                    </MudButton>

                    <InputFile id="fileInput" OnChange="HandleFileSelected" style="display:none;" />
                    </MudItem>
                </MudItem>
                <MudItem xs="12" class="d-flex justify-center mb-4">
                    <MudButton Variant="Variant.Filled" FullWidth="true" Class="AddBtn" OnClick="Submit">Update</MudButton>
                </MudItem>
            </MudGrid>
        </MudPaper>
    </DialogContent>
    <DialogActions>
    </DialogActions>
</MudDialog>

<style>
    .mud-dialog-title {
        padding-top: 3px;
    }

    .blur {
        backdrop-filter: blur(10px);
    }

    .dialog-background {
        background-color: transparent;
    }

    .dialog-background-title {
        background: rgba(0, 0, 0, 0.5);
        color: var(--mud-palette-white);
    }

    .dialog-background-surface {
        background: rgba(255, 255, 255, 0.75);
    }

    .head-container {
        display: flex;
        justify-content: space-between
    }

    .heading-txt {
        color: #000;
        font-family: Inter;
        font-size: 25px;
        font-style: normal;
        font-weight: 800;
        line-height: normal;
    }

    .custom-select-new-notifaction {
        border-radius: 4px;
        border: 0.5px solid #3A3A3A;
        box-sizing: border-box;
        background-color: #fff;
        font-family: 'Inter', sans-serif;
        font-size: 18px;
        font-weight: 600;
        color: #000;
        outline: none;
        text-align: center;
        width: 100%;
        padding: 10px;
        height: 57px;
    }

    .custom-label {
        display: block;
        font-family: 'Inter', sans-serif;
        font-size: 17px;
        font-style: normal;
        font-weight: 600;
        line-height: normal;
        margin-bottom: 10px;
    }

    .custom-input {
        width: 100%;
        border-radius: 5px;
        border: 0.5px solid #555454;
        padding: 8px;
        box-sizing: border-box;
        height: 57px;
        padding: 10px;
        justify-content: center;
        align-items: center;
        gap: 10px;
        align-self: stretch;
        color: #000;
        font-family: Inter;
        font-size: 17px;
        font-style: normal;
        font-weight: 600;
        line-height: normal;
    }

    .notification-description {
        font-family: 'Inter', sans-serif;
        font-size: 17px;
        font-style: normal;
        font-weight: 500;
        line-height: 23px;
        color: #000;
        width: 100%;
        height: 100px;
        padding: 10px;
        border-radius: 8px;
        background-color: #fff;
        box-sizing: border-box;
        resize: vertical;
        display: flex;
        height: 216px;
        padding: 16px 10px;
        border: 0.5px solid #555454;
    }

        .notification-description:focus {
            outline: none;
        }

    .user-container {
        gap: 15px;
    }

    .avatar-container {
        width: 100px !important;
        height: 100px !important;
        border: 0.1px solid #CBCBCB;
        border-radius: 15px;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        background: #D9D9D9;
    }

    .avatar-img {
        object-fit: fill;
        object-position: center;
        width: 100px;
        height: 100px;
    }

    .upload-btn {
        color: #0074E3;
        border-color: #0074E3;
        text-transform: capitalize
    }

    .AddBtn {
        padding: 10px;
        justify-content: center;
        align-items: center;
        gap: 10px;
        flex-shrink: 0;
        border-radius: 8px;
        border: 0.5px #555454;
        background-color: #0074E3;
        color: #fff;
        text-transform: capitalize;
    }

        .AddBtn:hover {
            padding: 10px;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
            border-radius: 8px;
            border: 0.5px #555454;
            background: #0074E3;
            color: #fff;
            text-transform: capitalize;
        }

</style>
@code {
    [CascadingParameter]
    private MudDialogInstance MudDialog { get; set; }

    private void Submit()
    {
        MudDialog.Close(DialogResult.Ok(true));
    }

    private void Cancel()
    {
        MudDialog.Cancel();
    }

    private string AvatarImageSrc { get; set; } = "./Images/Category-upload-icon.svg";
    private bool IsImageUploaded { get; set; } = false;


    [Inject] IJSRuntime JS { get; set; }

    private async Task HandleFileSelected(InputFileChangeEventArgs e)
    {
        var file = e.File;
        if (file != null)
        {
            using var memoryStream = new MemoryStream();
            await file.OpenReadStream().CopyToAsync(memoryStream);
            var base64 = Convert.ToBase64String(memoryStream.ToArray());
            AvatarImageSrc = $"data:{file.ContentType};base64,{base64}";
            IsImageUploaded = true;
        }
    }

    private async Task TriggerFileUpload()
    {
        await JS.InvokeVoidAsync("triggerFileInputClick", "fileInput");
    }

    private void RemoveImage()
    {
        AvatarImageSrc = "./Images/Category-upload-icon.svg";
        IsImageUploaded = false;
    }
}
